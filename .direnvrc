path_add() {
  local var_name="$1"
  # split existing paths into an array
  declare -a path_array
  IFS=: read -ra path_array <<< "${!1}"
  shift

  # prepend the passed paths in the right order
  for (( i=$# ; i>0 ; i-- )); do
    path_array=( "$(expand_path "${!i}")" "${path_array[@]}" )
  done

  # join back all the paths
  local path=$(IFS=:; echo "${path_array[*]}")

  # and finally export back the result to the original variable
  export "$var_name=$path"
}

function use_postgresql {
  export PGHOST=localhost
}

[ -d bin ] && [ -f Gemfile.lock ] && PATH_add bin || :
[ -d node_modules/.bin ] && PATH_add node_modules/.bin || :
[ -x bin/yarn ] && PATH_add /opt/local/libexec/yarn/bin || :
